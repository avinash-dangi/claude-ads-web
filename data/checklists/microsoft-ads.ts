import { AuditCheck, AuditCategory, PlatformAudit } from '@/types/audit';

export const microsoftAdsCategories: AuditCategory[] = [
  {
    name: 'UET Tag & Conversion Tracking',
    weight: 0.30,
    checkCount: 5,
    description: 'UET tag setup and conversion tracking',
  },
  {
    name: 'Campaign Organization',
    weight: 0.25,
    checkCount: 5,
    description: 'Account and campaign structure',
  },
  {
    name: 'Keyword Strategy',
    weight: 0.20,
    checkCount: 5,
    description: 'Keyword quality and targeting',
  },
  {
    name: 'Bing Shopping Setup',
    weight: 0.15,
    checkCount: 4,
    description: 'Shopping campaigns and product feeds',
  },
  {
    name: 'Budget & Bidding',
    weight: 0.10,
    checkCount: 3,
    description: 'Bid strategy and budget allocation',
  },
];

export const microsoftAdsChecks: AuditCheck[] = [
  // UET Tag & Conversion Tracking (30% weight)
  {
    id: 'M01',
    check: 'UET (Universal Event Tracking) tag installed',
    severity: 'critical',
    category: 'UET Tag & Conversion Tracking',
    pass: 'UET tag present on all website pages and firing',
    warning: 'UET tag installed but missing on some pages',
    fail: 'UET tag not installed',
  },
  {
    id: 'M02',
    check: 'Conversion goals configured and tracking',
    severity: 'critical',
    category: 'UET Tag & Conversion Tracking',
    pass: 'All key conversion goals tracked (leads, sales, signups)',
    warning: 'Some conversion goals tracked but incomplete',
    fail: 'No conversion goals configured',
  },
  {
    id: 'M03',
    check: 'Revenue tracking enabled for e-commerce',
    severity: 'high',
    category: 'UET Tag & Conversion Tracking',
    pass: 'Purchase events tracked with revenue values',
    warning: 'Revenue tracking present but may have gaps',
    fail: 'No revenue tracking for purchases',
  },
  {
    id: 'M04',
    check: 'Audience targeting lists synced',
    severity: 'high',
    category: 'UET Tag & Conversion Tracking',
    pass: 'Remarketing audiences created and syncing correctly',
    warning: 'Remarketing audiences exist but not optimized',
    fail: 'No audience lists configured',
  },
  {
    id: 'M05',
    check: 'Customer Match list imported',
    severity: 'medium',
    category: 'UET Tag & Conversion Tracking',
    pass: 'Customer email list imported and synced',
    warning: 'Customer Match configured but not updated regularly',
    fail: 'No Customer Match setup',
  },

  // Campaign Organization (25% weight)
  {
    id: 'M06',
    check: 'Account structure organized by business unit or product',
    severity: 'high',
    category: 'Campaign Organization',
    pass: 'Clear account hierarchy with separate campaigns per product/service',
    warning: 'Some organization but could be clearer',
    fail: 'Random campaign structure',
  },
  {
    id: 'M07',
    check: 'Ad groups logically segmented',
    severity: 'high',
    category: 'Campaign Organization',
    pass: 'Ad groups organized by keyword theme and intent',
    warning: 'Ad groups exist but organization could improve',
    fail: 'Keywords scattered across ad groups',
  },
  {
    id: 'M08',
    check: 'Negative keywords implemented at campaign/account level',
    severity: 'high',
    category: 'Campaign Organization',
    pass: 'Comprehensive negative keyword lists preventing irrelevant clicks',
    warning: 'Negative keywords present but gaps exist',
    fail: 'No negative keywords',
  },
  {
    id: 'M09',
    check: 'Device bid adjustments optimized',
    severity: 'medium',
    category: 'Campaign Organization',
    pass: 'Bid multipliers set for mobile, tablet, desktop based on data',
    warning: 'Device bids set but not optimized',
    fail: 'Using default device bids',
  },
  {
    id: 'M10',
    check: 'Location targeting appropriate',
    severity: 'medium',
    category: 'Campaign Organization',
    pass: 'Targeting only relevant geographic locations',
    warning: 'Location targeting too broad',
    fail: 'Targeting globally when should be limited',
  },

  // Keyword Strategy (20% weight)
  {
    id: 'M11',
    check: 'Keyword match types used strategically',
    severity: 'high',
    category: 'Keyword Strategy',
    pass: 'Mix of broad, phrase, and exact match keywords with good coverage',
    warning: 'Some match types used but not optimized',
    fail: 'Using only one match type',
  },
  {
    id: 'M12',
    check: 'Keyword Quality Score acceptable (6+)',
    severity: 'high',
    category: 'Keyword Strategy',
    pass: 'Most keywords have Quality Score 7+',
    warning: 'Some keywords with Quality Score 4-6',
    fail: 'Many keywords with Quality Score <4',
  },
  {
    id: 'M13',
    check: 'High-intent keywords prioritized',
    severity: 'high',
    category: 'Keyword Strategy',
    pass: 'Focus on high-intent keywords (buy, demo, pricing)',
    warning: 'Mix of high and low intent keywords',
    fail: 'Targeting mostly informational keywords',
  },
  {
    id: 'M14',
    check: 'Search term reports reviewed regularly',
    severity: 'medium',
    category: 'Keyword Strategy',
    pass: 'Search terms reviewed monthly and new keywords/negatives added',
    warning: 'Search terms reviewed but not acted upon',
    fail: 'Search term reports not reviewed',
  },
  {
    id: 'M15',
    check: 'Long-tail keywords included in strategy',
    severity: 'medium',
    category: 'Keyword Strategy',
    pass: 'Mix of head and long-tail keywords for coverage',
    warning: 'Some long-tail keywords but could be more',
    fail: 'Only short, broad keywords',
  },

  // Bing Shopping Setup (15% weight)
  {
    id: 'M16',
    check: 'Product feed properly configured',
    severity: 'critical',
    category: 'Bing Shopping Setup',
    pass: 'Product feed complete with all required fields and accurate data',
    warning: 'Feed configured but missing some data',
    fail: 'No product feed configured',
  },
  {
    id: 'M17',
    check: 'Shopping campaigns properly segmented',
    severity: 'high',
    category: 'Bing Shopping Setup',
    pass: 'Shopping campaigns organized by product category',
    warning: 'Shopping campaigns exist but organization unclear',
    fail: 'No shopping campaigns',
  },
  {
    id: 'M18',
    check: 'Product feed data regularly updated',
    severity: 'high',
    category: 'Bing Shopping Setup',
    pass: 'Feed automatically updated daily with current inventory/pricing',
    warning: 'Feed updated but not automatically',
    fail: 'Feed rarely or never updated',
  },
  {
    id: 'M19',
    check: 'Merchant Center account fully configured',
    severity: 'high',
    category: 'Bing Shopping Setup',
    pass: 'Merchant account verified with all required information',
    warning: 'Merchant account basic but incomplete',
    fail: 'Merchant account not verified',
  },

  // Budget & Bidding (10% weight)
  {
    id: 'M20',
    check: 'Bid strategy aligned with business goals',
    severity: 'high',
    category: 'Budget & Bidding',
    pass: 'Using ECPC, CPA, or ROAS bidding matched to goal',
    warning: 'Manual bidding used',
    fail: 'Bidding not optimized',
  },
  {
    id: 'M21',
    check: 'Campaign budget sufficient for learning phase',
    severity: 'medium',
    category: 'Budget & Bidding',
    pass: 'Budget allows 40-50 conversions/day during learning',
    warning: 'Budget may be limiting learning phase',
    fail: 'Budget too low for effective optimization',
  },
  {
    id: 'M22',
    check: 'Bid adjustments for top-performing segments',
    severity: 'medium',
    category: 'Budget & Bidding',
    pass: 'Bid multipliers increased for top-converting keywords/audiences',
    warning: 'Bid adjustments exist but not optimal',
    fail: 'No bid adjustments',
  },
];

export const microsoftAudit: PlatformAudit = {
  platform: 'microsoft-ads',
  totalChecks: microsoftAdsChecks.length,
  categories: microsoftAdsCategories,
  checks: microsoftAdsChecks,
};
